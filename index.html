<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Crystal Docs 1.4.1">
<meta name="crystal_docs.project_version" content="1.0.0">
<meta name="crystal_docs.project_name" content="anyolite">



<link href="css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/doc.js"></script>

  <meta name="repository-name" content="anyolite">
  <title>anyolite 1.0.0</title>
  <script type="text/javascript">
  CrystalDocs.base_path = "";
  </script>
</head>
<body>

<svg class="hidden">
  <symbol id="octicon-link" viewBox="0 0 16 16">
    <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
  </symbol>
</svg>
<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="project-summary">
      <h1 class="project-name">
        <a href="index.html">
          anyolite
        </a>
      </h1>

      <span class="project-version">
        1.0.0
      </span>
    </div>
  </div>

  <div class="search-results hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class="parent " data-id="anyolite/Anyolite" data-name="anyolite">
      <a href="Anyolite.html">Anyolite</a>
      
        <ul>
  
  <li class=" " data-id="anyolite/Anyolite/AddBlockArg" data-name="anyolite::addblockarg">
      <a href="Anyolite/AddBlockArg.html">AddBlockArg</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/AddBlockArgClassMethod" data-name="anyolite::addblockargclassmethod">
      <a href="Anyolite/AddBlockArgClassMethod.html">AddBlockArgClassMethod</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/AddBlockArgInstanceMethod" data-name="anyolite::addblockarginstancemethod">
      <a href="Anyolite/AddBlockArgInstanceMethod.html">AddBlockArgInstanceMethod</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/DefaultOptionalArgsToKeywordArgs" data-name="anyolite::defaultoptionalargstokeywordargs">
      <a href="Anyolite/DefaultOptionalArgsToKeywordArgs.html">DefaultOptionalArgsToKeywordArgs</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/Empty" data-name="anyolite::empty">
      <a href="Anyolite/Empty.html">Empty</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/Exclude" data-name="anyolite::exclude">
      <a href="Anyolite/Exclude.html">Exclude</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/ExcludeClassMethod" data-name="anyolite::excludeclassmethod">
      <a href="Anyolite/ExcludeClassMethod.html">ExcludeClassMethod</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/ExcludeConstant" data-name="anyolite::excludeconstant">
      <a href="Anyolite/ExcludeConstant.html">ExcludeConstant</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/ExcludeInstanceMethod" data-name="anyolite::excludeinstancemethod">
      <a href="Anyolite/ExcludeInstanceMethod.html">ExcludeInstanceMethod</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/ForceKeywordArg" data-name="anyolite::forcekeywordarg">
      <a href="Anyolite/ForceKeywordArg.html">ForceKeywordArg</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/ForceKeywordArgClassMethod" data-name="anyolite::forcekeywordargclassmethod">
      <a href="Anyolite/ForceKeywordArgClassMethod.html">ForceKeywordArgClassMethod</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/ForceKeywordArgInstanceMethod" data-name="anyolite::forcekeywordarginstancemethod">
      <a href="Anyolite/ForceKeywordArgInstanceMethod.html">ForceKeywordArgInstanceMethod</a>
      
    </li>
  
  <li class="parent " data-id="anyolite/Anyolite/HelperClasses" data-name="anyolite::helperclasses">
      <a href="Anyolite/HelperClasses.html">HelperClasses</a>
      
        <ul>
  
  <li class=" " data-id="anyolite/Anyolite/HelperClasses/AnyolitePointer" data-name="anyolite::helperclasses::anyolitepointer">
      <a href="Anyolite/HelperClasses/AnyolitePointer.html">AnyolitePointer</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/IgnoreAncestorMethods" data-name="anyolite::ignoreancestormethods">
      <a href="Anyolite/IgnoreAncestorMethods.html">IgnoreAncestorMethods</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/Include" data-name="anyolite::include">
      <a href="Anyolite/Include.html">Include</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/IncludeInstanceMethod" data-name="anyolite::includeinstancemethod">
      <a href="Anyolite/IncludeInstanceMethod.html">IncludeInstanceMethod</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/Macro" data-name="anyolite::macro">
      <a href="Anyolite/Macro.html">Macro</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/NoKeywordArgs" data-name="anyolite::nokeywordargs">
      <a href="Anyolite/NoKeywordArgs.html">NoKeywordArgs</a>
      
    </li>
  
  <li class="parent " data-id="anyolite/Anyolite/Preloader" data-name="anyolite::preloader">
      <a href="Anyolite/Preloader.html">Preloader</a>
      
        <ul>
  
  <li class=" " data-id="anyolite/Anyolite/Preloader/AtCompiletime" data-name="anyolite::preloader::atcompiletime">
      <a href="Anyolite/Preloader/AtCompiletime.html">AtCompiletime</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/RbArgCache" data-name="anyolite::rbargcache">
      <a href="Anyolite/RbArgCache.html">RbArgCache</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/RbCast" data-name="anyolite::rbcast">
      <a href="Anyolite/RbCast.html">RbCast</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/RbClass" data-name="anyolite::rbclass">
      <a href="Anyolite/RbClass.html">RbClass</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/RbClassCache" data-name="anyolite::rbclasscache">
      <a href="Anyolite/RbClassCache.html">RbClassCache</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/RbInterpreter" data-name="anyolite::rbinterpreter">
      <a href="Anyolite/RbInterpreter.html">RbInterpreter</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/RbModule" data-name="anyolite::rbmodule">
      <a href="Anyolite/RbModule.html">RbModule</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/RbRef" data-name="anyolite::rbref">
      <a href="Anyolite/RbRef.html">RbRef</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/RbRefTable" data-name="anyolite::rbreftable">
      <a href="Anyolite/RbRefTable.html">RbRefTable</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/RbTypeCache" data-name="anyolite::rbtypecache">
      <a href="Anyolite/RbTypeCache.html">RbTypeCache</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/Rename" data-name="anyolite::rename">
      <a href="Anyolite/Rename.html">Rename</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/RenameClass" data-name="anyolite::renameclass">
      <a href="Anyolite/RenameClass.html">RenameClass</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/RenameClassMethod" data-name="anyolite::renameclassmethod">
      <a href="Anyolite/RenameClassMethod.html">RenameClassMethod</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/RenameConstant" data-name="anyolite::renameconstant">
      <a href="Anyolite/RenameConstant.html">RenameConstant</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/RenameInstanceMethod" data-name="anyolite::renameinstancemethod">
      <a href="Anyolite/RenameInstanceMethod.html">RenameInstanceMethod</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/RenameModule" data-name="anyolite::renamemodule">
      <a href="Anyolite/RenameModule.html">RenameModule</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/ReturnNil" data-name="anyolite::returnnil">
      <a href="Anyolite/ReturnNil.html">ReturnNil</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/ReturnNilClassMethod" data-name="anyolite::returnnilclassmethod">
      <a href="Anyolite/ReturnNilClassMethod.html">ReturnNilClassMethod</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/ReturnNilInstanceMethod" data-name="anyolite::returnnilinstancemethod">
      <a href="Anyolite/ReturnNilInstanceMethod.html">ReturnNilInstanceMethod</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/Specialize" data-name="anyolite::specialize">
      <a href="Anyolite/Specialize.html">Specialize</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/SpecializeClassMethod" data-name="anyolite::specializeclassmethod">
      <a href="Anyolite/SpecializeClassMethod.html">SpecializeClassMethod</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/SpecializeInstanceMethod" data-name="anyolite::specializeinstancemethod">
      <a href="Anyolite/SpecializeInstanceMethod.html">SpecializeInstanceMethod</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/SpecifyGenericTypes" data-name="anyolite::specifygenerictypes">
      <a href="Anyolite/SpecifyGenericTypes.html">SpecifyGenericTypes</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/StoreBlockArg" data-name="anyolite::storeblockarg">
      <a href="Anyolite/StoreBlockArg.html">StoreBlockArg</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/StoreBlockArgClassMethod" data-name="anyolite::storeblockargclassmethod">
      <a href="Anyolite/StoreBlockArgClassMethod.html">StoreBlockArgClassMethod</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/StoreBlockArgInstanceMethod" data-name="anyolite::storeblockarginstancemethod">
      <a href="Anyolite/StoreBlockArgInstanceMethod.html">StoreBlockArgInstanceMethod</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/StructWrapper" data-name="anyolite::structwrapper(t)">
      <a href="Anyolite/StructWrapper.html">StructWrapper</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/Undefined" data-name="anyolite::undefined">
      <a href="Anyolite/Undefined.html">Undefined</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/WrapWithoutKeywords" data-name="anyolite::wrapwithoutkeywords">
      <a href="Anyolite/WrapWithoutKeywords.html">WrapWithoutKeywords</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/WrapWithoutKeywordsClassMethod" data-name="anyolite::wrapwithoutkeywordsclassmethod">
      <a href="Anyolite/WrapWithoutKeywordsClassMethod.html">WrapWithoutKeywordsClassMethod</a>
      
    </li>
  
  <li class=" " data-id="anyolite/Anyolite/WrapWithoutKeywordsInstanceMethod" data-name="anyolite::wrapwithoutkeywordsinstancemethod">
      <a href="Anyolite/WrapWithoutKeywordsInstanceMethod.html">WrapWithoutKeywordsInstanceMethod</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<h1><a id="anyolite" class="anchor" href="#anyolite">  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Anyolite</h1>
<p>Anyolite is a Crystal shard which adds a fully functional mruby (or even regular Ruby) interpreter to Crystal.</p>
<p><img src="https://github.com/Anyolite/anyolite/workflows/Test/badge.svg" alt="Test" /></p>
<p><img src="https://img.shields.io/github/v/release/Anyolite/anyolite" alt="Release" />
<img src="https://img.shields.io/github/release-date/Anyolite/anyolite" alt="ReleaseDate" /></p>
<p><img src="https://img.shields.io/github/license/Anyolite/anyolite" alt="License" /></p>
<h1><a id="description" class="anchor" href="#description">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Description</h1>
<p>Anyolite allows for wrapping Crystal classes and functions into Ruby with little effort.
This way, Ruby can be used as a scripting language to Crystal projects, with the major advantage of a similar syntax.</p>
<p>Useful links for an overview:</p>
<ul>
<li>Demo project: https://github.com/Anyolite/ScapoLite</li>
<li>Wiki: https://github.com/Anyolite/anyolite/wiki</li>
<li>Documentation: https://anyolite.github.io/anyolite</li>
</ul>
<h1><a id="features" class="anchor" href="#features">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Features</h1>
<ul>
<li>Bindings to an mruby interpreter</li>
<li>Near complete support to regular Ruby as alternative implementation (also known as MRI or CRuby)</li>
<li>Wrapping of nearly arbitrary Crystal classes and methods to Ruby</li>
<li>Easy syntax without unnecessary boilerplate code</li>
<li>Simple system to prevent garbage collector conflicts</li>
<li>Support for keyword arguments and default values</li>
<li>Objects, arrays, hashes, structs, enums and unions as function arguments and return values are completely valid</li>
<li>Ruby methods can be called at runtime as long as all their possible return value types are known</li>
<li>Ruby closures can be handled as regular variables</li>
<li>Methods and constants can be excluded, modified or renamed with annotations</li>
<li>Options to compile scripts directly into the executable</li>
</ul>
<h1><a id="prerequisites" class="anchor" href="#prerequisites">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Prerequisites</h1>
<p>You need to have the following programs installed (and in your PATH variable, if you are on Windows):</p>
<ul>
<li>Ruby (for building mruby)</li>
<li>Rake (for building the whole project)</li>
<li>Git (for downloading mruby)</li>
<li>GCC or Microsoft Visual Studio 19 (for building the object files required for Anyolite, depending on your OS)</li>
</ul>
<h2><a id="using-regular-ruby-instead-of-mruby" class="anchor" href="#using-regular-ruby-instead-of-mruby">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Using regular Ruby instead of mruby</h2>
<p>It is possible to use Anyolite with regular Ruby (MRI) instead of mruby. An instruction to install MRI can be found at <a href="https://github.com/Anyolite/anyolite/wiki/Using-Ruby-instead-of-mruby">Using Ruby instead of mruby</a> in the wiki.</p>
<h1><a id="installing" class="anchor" href="#installing">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Installing</h1>
<p>Put this shard as a requirement into your shard.yml project file and then call</p>
<pre><code class="language-bash">shards install</code></pre>
<p>from a terminal or the MSVC Developer Console (on Windows).</p>
<p>Alternatively, you can clone this repository into the lib folder of your project and run</p>
<pre><code class="language-bash">rake build_shard</code></pre>
<p>manually to install the shard without using the crystal shards program.</p>
<p>If you want to use other options for Anyolite, visit <a href="https://github.com/Anyolite/anyolite/wiki/Changing-build-configurations">Changing build configurations</a> in the wiki.</p>
<h1><a id="how-to-use" class="anchor" href="#how-to-use">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>How to use</h1>
<p>Imagine a Crystal class for a really bad RPG:</p>
<pre><code class="language-crystal"><span class="k">module</span> <span class="t">RPGTest</span>
  <span class="k">class</span> <span class="t">Entity</span>
    property hp : <span class="t">Int32</span>

    <span class="k">def</span> <span class="m">initialize</span>(@hp : <span class="t">Int32</span>)
    <span class="k">end</span>

    <span class="k">def</span> <span class="m">damage</span>(diff : <span class="t">Int32</span>)
      @hp -= diff
    <span class="k">end</span>

    <span class="k">def</span> <span class="m">yell</span>(sound : <span class="t">String</span>, loud : <span class="t">Bool</span> <span class="o">=</span> <span class="n">false</span>)
      <span class="k">if</span> loud
        puts <span class="s">&quot;Entity yelled: </span><span class="i">#{</span>sound.upcase<span class="i">}</span><span class="s">&quot;</span>
      <span class="k">else</span>
        puts <span class="s">&quot;Entity yelled: </span><span class="i">#{</span>sound<span class="i">}</span><span class="s">&quot;</span>
      <span class="k">end</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="m">absorb_hp_from</span>(other : <span class="t">Entity</span>)
      @hp += other.hp
      other.hp <span class="o">=</span> <span class="n">0</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
<p>Now, you want to wrap this class in Ruby. All you need to do is to execute the following code in Crystal (current commit; see documentation page for the version of the latest release):</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;anyolite&quot;</span>

<span class="t">Anyolite</span><span class="t">::</span><span class="t">RbInterpreter</span>.create <span class="k">do</span> <span class="o">|</span>rb<span class="o">|</span>
  <span class="t">Anyolite</span>.wrap(rb, <span class="t">RPGTest</span>)

  rb.load_script_from_file(<span class="s">&quot;examples/hp_example.rb&quot;</span>)
<span class="k">end</span></code></pre>
<p>Well, that's it already.
The last line in the block calls the following example script:</p>
<pre><code class="language-ruby">a = RPGTest::Entity.new(hp: 20)
a.damage(diff: 13)
puts a.hp

b = RPGTest::Entity.new(hp: 10)
a.absorb_hp_from(other: b)
puts a.hp
puts b.hp
b.yell(sound: 'Ouch, you stole my HP!', loud: true)
a.yell(sound: 'Well, take better care of your public attributes!')</code></pre>
<p>The example above gives a good overview over the things you can already do with Anyolite.
More features will be added in the future.</p>
<h1><a id="limitations" class="anchor" href="#limitations">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Limitations</h1>
<p>See <a href="https://github.com/Anyolite/anyolite/wiki/Limitations-and-solutions">Limitations and solutions</a> in the Wiki section for a detailed list.</p>
<h1><a id="why-this-name" class="anchor" href="#why-this-name">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Why this name?</h1>
<p>https://en.wikipedia.org/wiki/Anyolite</p>
<p>In short, it is a rare variant of the crystalline mineral called zoisite, with ruby and other crystal shards (of pargasite) embedded.</p>
<p>The term 'anyoli' means 'green' in the Maasai language, thus naming 'anyolite'.</p>
<h1><a id="roadmap" class="anchor" href="#roadmap">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Roadmap</h1>
<h2><a id="upcoming-releases" class="anchor" href="#upcoming-releases">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Upcoming releases</h2>
<p>Currently none</p>
<h3><a id="later-releases" class="anchor" href="#later-releases">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Later releases</h3>
<ul>
<li>[ ] Automated generation of Ruby documentations for wrapped functions</li>
<li>[ ] MRI support on Windows (does currently not work for some reason)</li>
<li>[ ] Mac support and continuous integration</li>
</ul>
<h3><a id="wishlist-entries-might-not-be-possible-to-implement" class="anchor" href="#wishlist-entries-might-not-be-possible-to-implement">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Wishlist, entries might not be possible to implement</h3>
<ul>
<li>[ ] Splat argument and/or arbitrary keyword passing</li>
<li>[ ] Support for slices and bytes</li>
<li>[ ] Classes as argument type</li>
<li>[ ] Resolve context even in generic type union arguments</li>
<li>[ ] General improvement of type resolution</li>
<li>[ ] Bignum support</li>
</ul>
</div>
</body>
</html>
